# Plan 02-02: OAuth Flow & Settings Page

## Goal
Create settings page with OAuth URL generation and auth code exchange.

## Requirements Covered
- AMZN-01: User can generate Amazon OAuth authorization URL from settings page
- AMZN-02: User can paste auth code and app exchanges it for tokens within 5 minutes

## Tasks

### 1. Create Settings Page Layout
**File**: `app/(dashboard)/settings/page.tsx`

Settings page with:
- Amazon Connection section
- OAuth URL display with copy button
- Auth code input form

### 2. Create OAuth URL Generator
**File**: `lib/amazon.ts` (extend)

Function to generate authorization URL with proper scopes:
- advertising::campaign_management
- profile (for user identification)

### 3. Create Token Exchange API
**File**: `app/api/amazon/exchange/route.ts`

POST endpoint that:
- Receives auth code from form
- Exchanges for tokens via SDK
- Validates response
- Stores in database
- Returns success/error

### 4. Create Settings Actions
**File**: `app/(dashboard)/settings/actions.ts`

Server actions for:
- Exchanging auth code
- Getting current connection status

### 5. Add Settings Link to Dashboard Layout
Update dashboard layout to include settings navigation.

## Verification
- [ ] Settings page renders at /settings
- [ ] OAuth URL is displayed and copyable
- [ ] Auth code form submits to API
- [ ] Tokens are stored in database on success
- [ ] Error messages shown for invalid codes

## Estimated Complexity
Medium - Multiple new files and API integration.
