# Plan 03-01: Schema & Models

## Goal
Create database schema for campaigns, ad groups, keywords, metrics, and sync state.

## Requirements Covered
- SYNC-06 (partial): Foundation for two-phase pattern storage

## Tasks

### 1. Update Prisma Schema
Add models for campaigns, ad groups, keywords, metrics, and sync state.

### 2. Run Migration
Create and apply database migration.

### 3. Create Type Definitions
TypeScript types matching API responses for type safety.

## Schema

```prisma
model Campaign {
  id           String    @id
  profileId    String
  type         String    // SP, SB, SD
  name         String
  state        String    // enabled, paused, archived
  budget       Float?
  budgetType   String?   // daily
  startDate    String?
  endDate      String?
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  syncedAt     DateTime?
  adGroups     AdGroup[]
  metrics      CampaignMetric[]
}

model AdGroup {
  id           String    @id
  campaignId   String
  campaign     Campaign  @relation(fields: [campaignId], references: [id], onDelete: Cascade)
  name         String
  state        String
  defaultBid   Float?
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  keywords     Keyword[]
}

model Keyword {
  id           String    @id
  adGroupId    String
  adGroup      AdGroup   @relation(fields: [adGroupId], references: [id], onDelete: Cascade)
  keywordText  String
  matchType    String    // exact, phrase, broad
  state        String
  bid          Float?
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  metrics      KeywordMetric[]
}

model CampaignMetric {
  id           String    @id @default(cuid())
  campaignId   String
  campaign     Campaign  @relation(fields: [campaignId], references: [id], onDelete: Cascade)
  date         String    // YYYYMMDD
  impressions  Int       @default(0)
  clicks       Int       @default(0)
  cost         Float     @default(0)
  orders       Int       @default(0)
  sales        Float     @default(0)
  createdAt    DateTime  @default(now())
  @@unique([campaignId, date])
  @@index([date])
}

model KeywordMetric {
  id           String    @id @default(cuid())
  keywordId    String
  keyword      Keyword   @relation(fields: [keywordId], references: [id], onDelete: Cascade)
  date         String
  impressions  Int       @default(0)
  clicks       Int       @default(0)
  cost         Float     @default(0)
  orders       Int       @default(0)
  sales        Float     @default(0)
  createdAt    DateTime  @default(now())
  @@unique([keywordId, date])
  @@index([date])
}

model SyncState {
  id           String    @id @default(cuid())
  profileId    String    @unique
  lastSyncAt   DateTime?
  syncStatus   String    @default("idle")
  error        String?
  updatedAt    DateTime  @updatedAt
}
```

## Verification
- [ ] Prisma schema compiles
- [ ] Migration runs successfully
- [ ] Types are exported

## Estimated Complexity
Low - Schema definition only.
