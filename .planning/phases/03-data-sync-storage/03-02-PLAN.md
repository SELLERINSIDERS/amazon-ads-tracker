# Plan 03-02: API Fetchers

## Goal
Create API wrapper functions to fetch campaigns, ad groups, and keywords from Amazon.

## Requirements Covered
- SYNC-01: Sync SP campaigns, ad groups, keywords
- SYNC-02: Sync SB and SD campaigns
- SYNC-03: Respect rate limits

## Tasks

### 1. Create Campaign Fetchers
Functions to fetch SP, SB, SD campaigns with pagination.

### 2. Create Ad Group Fetchers
Functions to fetch ad groups for each campaign type.

### 3. Create Keyword Fetchers
Functions to fetch keywords for SP and SB.

### 4. Add Pagination Support
Handle nextToken/cursor pagination.

### 5. Integrate Rate Limiting
Use withRateLimit for all API calls.

## API Patterns

```typescript
// lib/amazon-api.ts

// Fetch SP campaigns
async function fetchSPCampaigns(accessToken: string, profileId: string): Promise<SPCampaign[]>

// Fetch SB campaigns
async function fetchSBCampaigns(accessToken: string, profileId: string): Promise<SBCampaign[]>

// Fetch SD campaigns
async function fetchSDCampaigns(accessToken: string, profileId: string): Promise<SDCampaign[]>

// Fetch ad groups for campaign
async function fetchAdGroups(accessToken: string, profileId: string, campaignId: string, type: string): Promise<AdGroup[]>

// Fetch keywords for ad group
async function fetchKeywords(accessToken: string, profileId: string, adGroupId: string): Promise<Keyword[]>
```

## Headers Required

```
Amazon-Advertising-API-ClientId: {clientId}
Amazon-Advertising-API-Scope: {profileId}
Authorization: Bearer {accessToken}
Content-Type: application/json
```

## Verification
- [ ] SP campaign fetcher works
- [ ] SB campaign fetcher works
- [ ] SD campaign fetcher works
- [ ] Ad group fetcher works
- [ ] Keyword fetcher works
- [ ] Rate limiting is applied

## Estimated Complexity
Medium - Multiple API integrations with pagination.
