# Plan 08-01: Rules Database and Management UI

## Goal
Create database models for automation rules and management interface.

## Requirements Covered
- RULE-01: User can create automation rules with IF condition THEN action format
- RULE-02: User can toggle rules on/off
- RULE-05: App provides preset rule templates

## Tasks

### 1. Add AutomationRule and RuleExecution Models to Prisma
```prisma
model AutomationRule {
  id              String    @id @default(cuid())
  name            String
  description     String?
  enabled         Boolean   @default(true)
  conditionType   String
  conditionValue  Float
  conditionEntity String
  actionType      String
  actionValue     Float?
  cooldownHours   Int       @default(24)
  lastExecutedAt  DateTime?
  executionCount  Int       @default(0)
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
}

model RuleExecution {
  id         String   @id @default(cuid())
  ruleId     String
  entityType String
  entityId   String
  entityName String?
  result     String
  message    String?
  executedAt DateTime @default(now())
}
```

### 2. Create Rules Service (lib/rules.ts)
- createRule(), updateRule(), deleteRule()
- listRules(), getRule()
- toggleRule()
- getPresetTemplates()

### 3. Create Rules Management Page (/rules)
- List all rules with status
- Create/edit rule form
- Toggle enable/disable
- Delete confirmation

### 4. Create Rule Builder Component
- Condition selector (IF)
- Action selector (THEN)
- Cooldown setting

## Preset Templates
1. High ACoS Reducer (ACoS > 50% → decrease bid 10%)
2. Low Performance Pauser (clicks > 100, orders = 0 → pause)
3. Winner Booster (ROAS > 3 → increase bid 5%)

## Verification
- [ ] Migration runs successfully
- [ ] Can create rules via UI
- [ ] Can toggle rules on/off
- [ ] Preset templates available

## Estimated Complexity
High
