# Plan 06-03: Audit Logging System

## Goal
Create audit logging service and audit log viewer page.

## Requirements Covered
- AUDT-02: Log every action with timestamp
- AUDT-03: Capture before/after state
- AUDT-04: Filterable audit log
- AUDT-07: Show actor and reason

## Tasks

### 1. Create Audit Service (lib/audit.ts)
```typescript
export async function logAction(entry: CreateAuditEntry): Promise<AuditEntry>
export async function getAuditLog(filters: AuditFilters): Promise<AuditEntry[]>
```

### 2. Create Audit Log Page (/settings/audit)
- Table with all audit entries
- Columns: timestamp, actor, action, entity, success
- Expandable rows to show before/after state

### 3. Create Filter Component
- Action type dropdown
- Entity type dropdown
- Date range selector
- Actor type filter

### 4. Add Audit Link to Settings Navigation
- Link in settings page or sidebar

### 5. Create State Diff Viewer Component
- JSON diff view for before/after states
- Highlight changes

## Action Types
- bid_change
- budget_change
- status_change
- keyword_add
- keyword_remove
- campaign_create

## Entity Types
- campaign
- keyword
- ad_group

## Actor Types
- user (manual action)
- agent (AI agent action)
- rule (automation rule action)

## Verification
- [ ] Audit entries can be created
- [ ] Audit log page renders
- [ ] Filters work correctly
- [ ] Before/after state displayed
- [ ] Actor and reason visible

## Estimated Complexity
Medium
